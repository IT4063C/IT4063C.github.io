"use strict";(self.webpackChunksite=self.webpackChunksite||[]).push([[4860],{4544:(t,n,e)=>{e.r(n),e.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>m,frontMatter:()=>r,metadata:()=>i,toc:()=>s});var a=e(7462),d=(e(7294),e(3905));e(8209);const r={title:"Importing from Different Data Sources",sidebar_position:2,draft:!1},o=void 0,i={unversionedId:"working-with-data/data-sources",id:"working-with-data/data-sources",title:"Importing from Different Data Sources",description:"We can construct a DataFrame from a variety of data sources. The most common data sources are:",source:"@site/content/course-notes/5.working-with-data/2.data-sources.md",sourceDirName:"5.working-with-data",slug:"/working-with-data/data-sources",permalink:"/course-notes/working-with-data/data-sources",draft:!1,editUrl:"https://github.com/IT4063C/IT4063C.github.io/tree/main/content/course-notes/5.working-with-data/2.data-sources.md",tags:[],version:"current",lastUpdatedBy:"Yahya Gilany",lastUpdatedAt:1679576950,formattedLastUpdatedAt:"Mar 23, 2023",sidebarPosition:2,frontMatter:{title:"Importing from Different Data Sources",sidebar_position:2,draft:!1},sidebar:"notes",previous:{title:"Numbers in Computers",permalink:"/course-notes/working-with-data/numbers-in-computers"},next:{title:"Exploratory Data Analysis (EDA)",permalink:"/course-notes/eda/"}},l={},s=[{value:"\ud83d\udce5 From CSV",id:"-from-csv",level:2},{value:"Downloading Dataset from Kaggle using <code>OpenDatasets</code>",id:"downloading-dataset-from-kaggle-using-opendatasets",level:3},{value:"\ud83d\udce5 From API",id:"-from-api",level:2},{value:"US Census Data",id:"us-census-data",level:3},{value:"John Hopkins Covid API",id:"john-hopkins-covid-api",level:3},{value:"\ud83d\udce5 Using Socrata",id:"-using-socrata",level:2},{value:"Cincinnati Datasets",id:"cincinnati-datasets",level:3},{value:"\ud83d\udce5 From SQL",id:"-from-sql",level:2},{value:"About SQL",id:"about-sql",level:3},{value:"\ud83d\udce5 From MongoDB",id:"-from-mongodb",level:2},{value:"\ud83d\udce5 Via Web Scrapping",id:"-via-web-scrapping",level:2},{value:"Sidebar: HTML Tables",id:"sidebar-html-tables",level:4}],h=t=>function(n){return console.warn("Component "+t+" was not imported, exported, or provided by MDXProvider as global scope"),(0,d.kt)("div",n)},p=h("HTMLOutputBlock"),c=h("CodeOutputBlock"),u={toc:s};function m(t){let{components:n,...r}=t;return(0,d.kt)("wrapper",(0,a.Z)({},u,r,{components:n,mdxType:"MDXLayout"}),(0,d.kt)("p",null,"We can construct a ",(0,d.kt)("inlineCode",{parentName:"p"},"DataFrame")," from a variety of data sources. The most common data sources are:"),(0,d.kt)("ul",null,(0,d.kt)("li",{parentName:"ul"},"CSV files"),(0,d.kt)("li",{parentName:"ul"},"Excel files"),(0,d.kt)("li",{parentName:"ul"},"SQL databases"),(0,d.kt)("li",{parentName:"ul"},"JSON files"),(0,d.kt)("li",{parentName:"ul"},"HTML files")),(0,d.kt)("p",null,"In this notes, we see some of those examples in action"),(0,d.kt)("h2",{id:"-from-csv"},"\ud83d\udce5 From CSV"),(0,d.kt)("pre",null,(0,d.kt)("code",{parentName:"pre",className:"language-python"},"import pandas as pd\nimport numpy as np\n")),(0,d.kt)("pre",null,(0,d.kt)("code",{parentName:"pre",className:"language-python"},'url = "https://raw.github.com/pandas-dev/pandas/main/pandas/tests/io/data/csv/tips.csv"\n\ntips = pd.read_csv(url)\ntips.head()\n')),(0,d.kt)(p,{mdxType:"HTMLOutputBlock"},(0,d.kt)("pre",null,(0,d.kt)("code",{parentName:"pre",className:"language-html"},'<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border="1" class="dataframe">\n  <thead>\n    <tr style="text-align: right;">\n      <th></th>\n      <th>total_bill</th>\n      <th>tip</th>\n      <th>sex</th>\n      <th>smoker</th>\n      <th>day</th>\n      <th>time</th>\n      <th>size</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>16.99</td>\n      <td>1.01</td>\n      <td>Female</td>\n      <td>No</td>\n      <td>Sun</td>\n      <td>Dinner</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>10.34</td>\n      <td>1.66</td>\n      <td>Male</td>\n      <td>No</td>\n      <td>Sun</td>\n      <td>Dinner</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>21.01</td>\n      <td>3.50</td>\n      <td>Male</td>\n      <td>No</td>\n      <td>Sun</td>\n      <td>Dinner</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>23.68</td>\n      <td>3.31</td>\n      <td>Male</td>\n      <td>No</td>\n      <td>Sun</td>\n      <td>Dinner</td>\n      <td>2</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>24.59</td>\n      <td>3.61</td>\n      <td>Female</td>\n      <td>No</td>\n      <td>Sun</td>\n      <td>Dinner</td>\n      <td>4</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n'))),(0,d.kt)("p",null,"The ",(0,d.kt)("inlineCode",{parentName:"p"},".head()")," function gets you the first 5 elements of the data frame to show what the data would look like."),(0,d.kt)("p",null,"You could also use the function ",(0,d.kt)("inlineCode",{parentName:"p"},"describe()")," which return summary statistics about the dataset"),(0,d.kt)("pre",null,(0,d.kt)("code",{parentName:"pre",className:"language-python"},"tips.describe()\n")),(0,d.kt)(p,{mdxType:"HTMLOutputBlock"},(0,d.kt)("pre",null,(0,d.kt)("code",{parentName:"pre",className:"language-html"},'<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border="1" class="dataframe">\n  <thead>\n    <tr style="text-align: right;">\n      <th></th>\n      <th>total_bill</th>\n      <th>tip</th>\n      <th>size</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>count</th>\n      <td>244.000000</td>\n      <td>244.000000</td>\n      <td>244.000000</td>\n    </tr>\n    <tr>\n      <th>mean</th>\n      <td>19.785943</td>\n      <td>2.998279</td>\n      <td>2.569672</td>\n    </tr>\n    <tr>\n      <th>std</th>\n      <td>8.902412</td>\n      <td>1.383638</td>\n      <td>0.951100</td>\n    </tr>\n    <tr>\n      <th>min</th>\n      <td>3.070000</td>\n      <td>1.000000</td>\n      <td>1.000000</td>\n    </tr>\n    <tr>\n      <th>25%</th>\n      <td>13.347500</td>\n      <td>2.000000</td>\n      <td>2.000000</td>\n    </tr>\n    <tr>\n      <th>50%</th>\n      <td>17.795000</td>\n      <td>2.900000</td>\n      <td>2.000000</td>\n    </tr>\n    <tr>\n      <th>75%</th>\n      <td>24.127500</td>\n      <td>3.562500</td>\n      <td>3.000000</td>\n    </tr>\n    <tr>\n      <th>max</th>\n      <td>50.810000</td>\n      <td>10.000000</td>\n      <td>6.000000</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n'))),(0,d.kt)("h3",{id:"downloading-dataset-from-kaggle-using-opendatasets"},"Downloading Dataset from Kaggle using ",(0,d.kt)("inlineCode",{parentName:"h3"},"OpenDatasets")),(0,d.kt)("p",null,"In cases where you're trying to use datasets that are available on online sources like ",(0,d.kt)("inlineCode",{parentName:"p"},"Kaggle"),". You can continue to use the URL directly, if the source makes one available. Or you could use a tool such as ",(0,d.kt)("inlineCode",{parentName:"p"},"opendatasets"),".\n",(0,d.kt)("inlineCode",{parentName:"p"},"opendatasets")," is a Python library for downloading datasets from online sources like ",(0,d.kt)("inlineCode",{parentName:"p"},"Kaggle")," and ",(0,d.kt)("inlineCode",{parentName:"p"},"Google Drive")," using a simple Python command."),(0,d.kt)("p",null,"The following examples show how you can (DOWNLOAD) the US Elections Dataset available via ",(0,d.kt)("inlineCode",{parentName:"p"},"Kaggle"),". You will be asked to provide your username and authentication API key (that's not the same as your account password)."),(0,d.kt)("p",null,(0,d.kt)("strong",{parentName:"p"},"To get your Kaggle API Key:"),"\n",(0,d.kt)("img",{alt:"Where to get your Kaggle API Key",src:e(7627).Z,width:"3584",height:"1972"})),(0,d.kt)("p",null,"this will download a file named ",(0,d.kt)("inlineCode",{parentName:"p"},"kaggle.json")," that contains your account name and a key that you'll use to authenticate in the following code cell."),(0,d.kt)("pre",null,(0,d.kt)("code",{parentName:"pre",className:"language-python"},"import opendatasets as od\ndataset_url = 'https://www.kaggle.com/tunguz/us-elections-dataset'\nod.download(dataset_url, data_dir='./data')\n")),(0,d.kt)(c,{lang:"python",mdxType:"CodeOutputBlock"},(0,d.kt)("pre",null,(0,d.kt)("code",{parentName:"pre"},'    Skipping, found downloaded files in "./data/us-elections-dataset" (use force=True to force download)\n'))),(0,d.kt)("p",null,"Once downloaded, you can Import the CSV file into a data frame."),(0,d.kt)("pre",null,(0,d.kt)("code",{parentName:"pre",className:"language-python"},"## import CSv file from local folder into a dataframe\nelections = pd.read_csv('./data/us-elections-dataset/1976-2020-president.csv')\nelections.head()\n")),(0,d.kt)(p,{mdxType:"HTMLOutputBlock"},(0,d.kt)("pre",null,(0,d.kt)("code",{parentName:"pre",className:"language-html"},'<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border="1" class="dataframe">\n  <thead>\n    <tr style="text-align: right;">\n      <th></th>\n      <th>year</th>\n      <th>state</th>\n      <th>state_po</th>\n      <th>state_fips</th>\n      <th>state_cen</th>\n      <th>state_ic</th>\n      <th>office</th>\n      <th>candidate</th>\n      <th>party_detailed</th>\n      <th>writein</th>\n      <th>candidatevotes</th>\n      <th>totalvotes</th>\n      <th>version</th>\n      <th>notes</th>\n      <th>party_simplified</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>1976</td>\n      <td>ALABAMA</td>\n      <td>AL</td>\n      <td>1</td>\n      <td>63</td>\n      <td>41</td>\n      <td>US PRESIDENT</td>\n      <td>CARTER, JIMMY</td>\n      <td>DEMOCRAT</td>\n      <td>False</td>\n      <td>659170</td>\n      <td>1182850</td>\n      <td>20210113</td>\n      <td>NaN</td>\n      <td>DEMOCRAT</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>1976</td>\n      <td>ALABAMA</td>\n      <td>AL</td>\n      <td>1</td>\n      <td>63</td>\n      <td>41</td>\n      <td>US PRESIDENT</td>\n      <td>FORD, GERALD</td>\n      <td>REPUBLICAN</td>\n      <td>False</td>\n      <td>504070</td>\n      <td>1182850</td>\n      <td>20210113</td>\n      <td>NaN</td>\n      <td>REPUBLICAN</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>1976</td>\n      <td>ALABAMA</td>\n      <td>AL</td>\n      <td>1</td>\n      <td>63</td>\n      <td>41</td>\n      <td>US PRESIDENT</td>\n      <td>MADDOX, LESTER</td>\n      <td>AMERICAN INDEPENDENT PARTY</td>\n      <td>False</td>\n      <td>9198</td>\n      <td>1182850</td>\n      <td>20210113</td>\n      <td>NaN</td>\n      <td>OTHER</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>1976</td>\n      <td>ALABAMA</td>\n      <td>AL</td>\n      <td>1</td>\n      <td>63</td>\n      <td>41</td>\n      <td>US PRESIDENT</td>\n      <td>BUBAR, BENJAMIN ""BEN""</td>\n      <td>PROHIBITION</td>\n      <td>False</td>\n      <td>6669</td>\n      <td>1182850</td>\n      <td>20210113</td>\n      <td>NaN</td>\n      <td>OTHER</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>1976</td>\n      <td>ALABAMA</td>\n      <td>AL</td>\n      <td>1</td>\n      <td>63</td>\n      <td>41</td>\n      <td>US PRESIDENT</td>\n      <td>HALL, GUS</td>\n      <td>COMMUNIST PARTY USE</td>\n      <td>False</td>\n      <td>1954</td>\n      <td>1182850</td>\n      <td>20210113</td>\n      <td>NaN</td>\n      <td>OTHER</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n'))),(0,d.kt)("h2",{id:"-from-api"},"\ud83d\udce5 From API"),(0,d.kt)("p",null,"To import data using an HTTP API in Python, you have multiple options for the HTTP client libraries. The one I choose and use here is ",(0,d.kt)("inlineCode",{parentName:"p"},"requests"),". Here I will show you how you can use ",(0,d.kt)("inlineCode",{parentName:"p"},"requests")," to query data from the US Census Data, and from the John Hopkins COVID APIs."),(0,d.kt)("p",null,"The most basic example is the following:"),(0,d.kt)("pre",null,(0,d.kt)("code",{parentName:"pre",className:"language-python"},"import requests\n\nx = requests.get('https://w3schools.com/python/demopage.htm')\n\nprint(x.text)\n")),(0,d.kt)("p",null,"However, depending on the API provider, we may need to pass additional configurations and options in the request. We'll see that in the following examples"),(0,d.kt)("h3",{id:"us-census-data"},"US Census Data"),(0,d.kt)("p",null,"The US Census Bureau provides machine-readable dataset via a developer API. "),(0,d.kt)("blockquote",null,(0,d.kt)("p",{parentName:"blockquote"},"Developers could use the statistics available through this API to create apps that:"),(0,d.kt)("ol",{parentName:"blockquote"},(0,d.kt)("li",{parentName:"ol"},"Show commuting patterns for every city in America."),(0,d.kt)("li",{parentName:"ol"},"Display the latest numbers on owners and renters in a neighborhood someone may want to live in."),(0,d.kt)("li",{parentName:"ol"},"Provide a local government a range of socioeconomic statistics on its population."))),(0,d.kt)("p",null,"Here are ",(0,d.kt)("a",{parentName:"p",href:"https://www.census.gov/data/developers/data-sets.html"},"some of the datasets available that you can use")),(0,d.kt)("p",null,"Each dataset provides technical documentation for the different variables you could get from that Particular API. Here's ",(0,d.kt)("a",{parentName:"p",href:"https://api.census.gov/data/2020/dec/pl/variables.html"},"an example")),(0,d.kt)("ul",null,(0,d.kt)("li",{parentName:"ul"},(0,d.kt)("a",{parentName:"li",href:"https://www.census.gov/content/dam/Census/library/publications/2020/acs/acs_api_handbook_2020_ch02.pdf"},"Working with US Census Data - PDF Guide"))),(0,d.kt)("p",null,"To construct a request with ",(0,d.kt)("inlineCode",{parentName:"p"},"requests")," we need to determine the URL we need to send the request to."),(0,d.kt)("pre",null,(0,d.kt)("code",{parentName:"pre",className:"language-python"},'import requests\n\nHOST = "https://api.census.gov/data"\nyear = "2022"\ndataset = "cps/basic/apr"\nbase_url = "/".join([HOST, year, dataset]) # JOIN the variables with a `/` separator https://api.census.gov/data/2022/cps/basic/apr\n\n# The dataset is huge and contains a lot of data, so we\'ll request a subset of the available variables.\ndataset_variables = ["GEDIV","HRMIS","PENATVTY"] \n\npredicates = {}\npredicates["get"] = ",".join(dataset_variables) # JOIN the variables with a `,` separator\npredicates["for"] = "state:*"\n\nresponse = requests.get(base_url, params=predicates)\n\ncensus_data = pd.DataFrame.from_records(response.json()[1:], columns=response.json()[0])\nprint(census_data.head())\n')),(0,d.kt)(c,{lang:"python",mdxType:"CodeOutputBlock"},(0,d.kt)("pre",null,(0,d.kt)("code",{parentName:"pre"},"      GEDIV HRMIS PENATVTY state\n    0     8     8      303     4\n    1     8     8      303     4\n    2     8     8       57     4\n    3     8     8       57     4\n    4     7     2       57     5\n"))),(0,d.kt)("p",null,"This ",(0,d.kt)("a",{parentName:"p",href:"https://api.census.gov/data/2022/cps/basic/apr/variables.html"},"link here")," describes what those variables mean."),(0,d.kt)("p",null,"Also, you note that even the states are presented with some numerical values. to get the values of those state IDs, I'll send another request to another dataset"),(0,d.kt)("pre",null,(0,d.kt)("code",{parentName:"pre",className:"language-python"},'import requests\n\nHOST = "https://api.census.gov/data"\nyear = "2017"\ndataset = "acs/acs5"\nbase_url = "/".join([HOST, year, dataset]) # JOIN the variables with a `/` separator https://api.census.gov/data/2022/cps/basic/apr\n\ndataset_variables = ["NAME"]\npredicates = {}\npredicates["get"] = ",".join(dataset_variables)\npredicates["for"] = "state:*"\n\nr = requests.get(base_url, params=predicates)\nstates = pd.DataFrame.from_records(r.json()[1:], columns=r.json()[0])\nprint(states.head())\n')),(0,d.kt)(c,{lang:"python",mdxType:"CodeOutputBlock"},(0,d.kt)("pre",null,(0,d.kt)("code",{parentName:"pre"},"              NAME state\n    0  Mississippi    28\n    1     Missouri    29\n    2      Montana    30\n    3     Nebraska    31\n    4       Nevada    32\n"))),(0,d.kt)("p",null,"You could subset the data recieved to find the State Numerical Code for the ",(0,d.kt)("inlineCode",{parentName:"p"},"Ohio")),(0,d.kt)("pre",null,(0,d.kt)("code",{parentName:"pre",className:"language-python"},'# Find the state code with the name "Ohio"\nprint(states[states["NAME"] == "Ohio"])\n')),(0,d.kt)(c,{lang:"python",mdxType:"CodeOutputBlock"},(0,d.kt)("pre",null,(0,d.kt)("code",{parentName:"pre"},"        NAME state\n    16  Ohio    39\n"))),(0,d.kt)("p",null,"or you could just combine and merge the 2 data sets on the state ID, so we end up with a single dataset with all the information we need."),(0,d.kt)("pre",null,(0,d.kt)("code",{parentName:"pre",className:"language-python"},'# Merge census_data and states\nfull_census_data = pd.merge(census_data, states, on="state")\nfull_census_data.head() # Print the first 5 rows\n')),(0,d.kt)(p,{mdxType:"HTMLOutputBlock"},(0,d.kt)("pre",null,(0,d.kt)("code",{parentName:"pre",className:"language-html"},'<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border="1" class="dataframe">\n  <thead>\n    <tr style="text-align: right;">\n      <th></th>\n      <th>GEDIV</th>\n      <th>HRMIS</th>\n      <th>PENATVTY</th>\n      <th>state</th>\n      <th>NAME</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>7</td>\n      <td>6</td>\n      <td>57</td>\n      <td>40</td>\n      <td>Oklahoma</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>7</td>\n      <td>6</td>\n      <td>57</td>\n      <td>40</td>\n      <td>Oklahoma</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>7</td>\n      <td>6</td>\n      <td>57</td>\n      <td>40</td>\n      <td>Oklahoma</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>7</td>\n      <td>6</td>\n      <td>57</td>\n      <td>40</td>\n      <td>Oklahoma</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>7</td>\n      <td>3</td>\n      <td>57</td>\n      <td>40</td>\n      <td>Oklahoma</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n'))),(0,d.kt)("h3",{id:"john-hopkins-covid-api"},"John Hopkins Covid API"),(0,d.kt)("p",null,"John Hopkins University | Cornoavirus Resources Center have been collecting and publishing data regarding COVID-19 since day one.\nYou can learn more about that and ",(0,d.kt)("a",{parentName:"p",href:"https://coronavirus.jhu.edu/about/how-to-use-our-data"},"find official resources for how to use the data here")),(0,d.kt)("p",null,"I believe someone is publishing those datasets by means of API through the RapidAPI platform. Whether it's an official resource or not, the goal of this exercise is to show you how to work with APIs in general."),(0,d.kt)("p",null,"You can see a very easy to understand documentation of ",(0,d.kt)("a",{parentName:"p",href:"https://rapidapi.com/axisbits-axisbits-default/api/covid-19-statistics/"},"how to use the API here"),". "),(0,d.kt)("pre",null,(0,d.kt)("code",{parentName:"pre",className:"language-python"},'import os\nfrom dotenv import load_dotenv\nimport requests\n\nload_dotenv(override=True)\nrapid_api_key = os.getenv("RAPID_API_KEY")\n\nurl = "https://covid-19-statistics.p.rapidapi.com/reports"\nquerystring = {"region_province":"Ohio","iso":"USA","region_name":"US","q":"US Ohio","date":"2020-04-16"}\n\nheaders = {\n    "X-RapidAPI-Key": rapid_api_key,\n    "X-RapidAPI-Host": "covid-19-statistics.p.rapidapi.com"\n}\n\nresponse = requests.request("GET", url, headers=headers, params=querystring)\n\n# save json result into a pandas dataframe\ncovid_data = pd.DataFrame(response.json()["data"][0]["region"]["cities"])\ncovid_data.head()\n')),(0,d.kt)(p,{mdxType:"HTMLOutputBlock"},(0,d.kt)("pre",null,(0,d.kt)("code",{parentName:"pre",className:"language-html"},'<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border="1" class="dataframe">\n  <thead>\n    <tr style="text-align: right;">\n      <th></th>\n      <th>name</th>\n      <th>date</th>\n      <th>fips</th>\n      <th>lat</th>\n      <th>long</th>\n      <th>confirmed</th>\n      <th>deaths</th>\n      <th>confirmed_diff</th>\n      <th>deaths_diff</th>\n      <th>last_update</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Adams</td>\n      <td>2020-04-16</td>\n      <td>39001</td>\n      <td>38.84541072</td>\n      <td>-83.4718964</td>\n      <td>3</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>2020-04-16 23:30:51</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Allen</td>\n      <td>2020-04-16</td>\n      <td>39003</td>\n      <td>40.77285242</td>\n      <td>-84.10802343</td>\n      <td>57</td>\n      <td>6</td>\n      <td>6</td>\n      <td>2</td>\n      <td>2020-04-16 23:30:51</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Ashland</td>\n      <td>2020-04-16</td>\n      <td>39005</td>\n      <td>40.84772277</td>\n      <td>-82.27280781</td>\n      <td>5</td>\n      <td>0</td>\n      <td>-1</td>\n      <td>0</td>\n      <td>2020-04-16 23:30:51</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Ashtabula</td>\n      <td>2020-04-16</td>\n      <td>39007</td>\n      <td>41.70860332</td>\n      <td>-80.74830218</td>\n      <td>45</td>\n      <td>3</td>\n      <td>9</td>\n      <td>0</td>\n      <td>2020-04-16 23:30:51</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Athens</td>\n      <td>2020-04-16</td>\n      <td>39009</td>\n      <td>39.33425634</td>\n      <td>-82.04278644</td>\n      <td>3</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>2020-04-16 23:30:51</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n'))),(0,d.kt)("h2",{id:"-using-socrata"},"\ud83d\udce5 Using Socrata"),(0,d.kt)("p",null,"The Socrata Open Data API allows you to programmatically access a wealth of open data resources from governments, non-profits, and NGOs around the world. "),(0,d.kt)("h3",{id:"cincinnati-datasets"},"Cincinnati Datasets"),(0,d.kt)("p",null,"For example, ",(0,d.kt)("a",{parentName:"p",href:"https://www.opendatanetwork.com/entity/1600000US3915000/Cincinnati_OH/demographics.population.count?ref=search-entity&year=2018"},"here are a bunch of datasets that you can find about the City of Cincinnati")),(0,d.kt)("p",null,"For you to be able to access any of those datasets, you need to register to get an application token."),(0,d.kt)("p",null,(0,d.kt)("img",{alt:"Cincinnati Data Portal",src:e(5222).Z,width:"3584",height:"1944"})),(0,d.kt)("pre",null,(0,d.kt)("code",{parentName:"pre",className:"language-python"},'import os\nfrom dotenv import load_dotenv\nimport pandas as pd\nfrom sodapy import Socrata\n\nload_dotenv(override=True)\n\n# Example authenticated client (needed for non-public datasets):\napp_token = os.getenv("SODA_APP_TOKEN")\n\n# client = Socrata("data.cincinnati-oh.gov", None)\nclient = Socrata("data.cincinnati-oh.gov",app_token)\n\n\n# First 2000 results, returned as JSON from API / converted to Python list of\n# dictionaries by sodapy.\nresults = client.get("rvmt-pkmq", limit=2000)\n\n# Convert to pandas DataFrame\nresults_df = pd.DataFrame.from_records(results)\nprint(results_df.columns)\n')),(0,d.kt)(c,{lang:"python",mdxType:"CodeOutputBlock"},(0,d.kt)("pre",null,(0,d.kt)("code",{parentName:"pre"},"    Index(['address_x', 'latitude_x', 'longitude_x', 'age',\n           'community_council_neighborhood', 'cpd_neighborhood',\n           'sna_neighborhood', 'crashdate', 'crashseverity', 'crashseverityid',\n           'datecrashreported', 'dayofweek', 'gender', 'injuries', 'instanceid',\n           'lightconditionsprimary', 'localreportno', 'mannerofcrash',\n           'roadconditionsprimary', 'roadcontour', 'roadsurface', 'unittype',\n           'typeofperson', 'weather', 'zip', 'roadclass', 'roadclassdesc'],\n          dtype='object')\n"))),(0,d.kt)("h2",{id:"-from-sql"},"\ud83d\udce5 From SQL"),(0,d.kt)("h3",{id:"about-sql"},"About SQL"),(0,d.kt)("p",null,"SQL is a powerful programming language that allows us to interact and save data in Relational Databases. SQL stores data in a table format, consisting of rows representing a number of records and columns corresponding to various features."),(0,d.kt)("p",null,"There are many categories categories of SQL commands:"),(0,d.kt)("ol",null,(0,d.kt)("li",{parentName:"ol"},(0,d.kt)("p",{parentName:"li"},"Data Definition Language (DDL)"),(0,d.kt)("ol",{parentName:"li"},(0,d.kt)("li",{parentName:"ol"},(0,d.kt)("inlineCode",{parentName:"li"},"CREATE"),", ",(0,d.kt)("inlineCode",{parentName:"li"},"ALTER"),", ",(0,d.kt)("inlineCode",{parentName:"li"},"DROP"),"; these are the commands used to define the data structure or the data model."))),(0,d.kt)("li",{parentName:"ol"},(0,d.kt)("p",{parentName:"li"},"Data Manipulation Language (DML)"),(0,d.kt)("ol",{parentName:"li"},(0,d.kt)("li",{parentName:"ol"},(0,d.kt)("inlineCode",{parentName:"li"},"INSERT"),", ",(0,d.kt)("inlineCode",{parentName:"li"},"UPDATE"),", ",(0,d.kt)("inlineCode",{parentName:"li"},"DELETE"),"; these are the commands used to modify data in existing databases."))),(0,d.kt)("li",{parentName:"ol"},(0,d.kt)("p",{parentName:"li"},"Data Query Language (DQL)"),(0,d.kt)("ol",{parentName:"li"},(0,d.kt)("li",{parentName:"ol"},(0,d.kt)("inlineCode",{parentName:"li"},"SELECT")))),(0,d.kt)("li",{parentName:"ol"},(0,d.kt)("p",{parentName:"li"},"Data Control Langauge (DCL)"),(0,d.kt)("ol",{parentName:"li"},(0,d.kt)("li",{parentName:"ol"},(0,d.kt)("inlineCode",{parentName:"li"},"GRANT"),", ",(0,d.kt)("inlineCode",{parentName:"li"},"REVOKE"),"; administrative commands to manage user permissions and access"))),(0,d.kt)("li",{parentName:"ol"},(0,d.kt)("p",{parentName:"li"},"Transaction Control Language (TCL)"),(0,d.kt)("ol",{parentName:"li"},(0,d.kt)("li",{parentName:"ol"},(0,d.kt)("inlineCode",{parentName:"li"},"COMMIT"),", ",(0,d.kt)("inlineCode",{parentName:"li"},"ROLLBACK"),", ",(0,d.kt)("inlineCode",{parentName:"li"},"BEGIN TRANSACTION"),"; for managing transaction queries where multiple DML are processed in a single operation. This is more for software developers than it is for data analysts.")))),(0,d.kt)("p",null,"While there is a SQL Standard, there are many dialects and implementations of that standard. You'll often hear of ",(0,d.kt)("inlineCode",{parentName:"p"},"Microsoft SQL Server"),", ",(0,d.kt)("inlineCode",{parentName:"p"},"MySQL"),", ",(0,d.kt)("inlineCode",{parentName:"p"},"PostgreSQL"),", ...etc. All of these require that the an instance of the server is hosted on some server or locally."),(0,d.kt)("p",null,"Another dialect of SQL is called ",(0,d.kt)("inlineCode",{parentName:"p"},"SQLite"),". This is a small, self-contained, serverless relational database system. This means that the entire database would be contained in a file. that can be shared with others. This has pros and cons."),(0,d.kt)("p",null,"For the purposes of demo-ing how we can use Python to interact with SQL Database, I'm using a sample SQLite database. The ",(0,d.kt)("a",{parentName:"p",href:"https://www.sqlitetutorial.net/sqlite-sample-database/"},"SQLite Tutorial Website")," offers same sample database for testing and training. "),(0,d.kt)("p",null,"I'm here demo-ing using the Chinook database in python. This is the database schema for the database tables."),(0,d.kt)("p",null,(0,d.kt)("img",{parentName:"p",src:"https://www.sqlitetutorial.net/wp-content/uploads/2015/11/sqlite-sample-database-color.jpg",alt:"DB Schema"})),(0,d.kt)("p",null,"First off, I'll download the sqlite database from ",(0,d.kt)("a",{parentName:"p",href:"https://www.sqlitetutorial.net/wp-content/uploads/2018/03/chinook.zip"},"https://www.sqlitetutorial.net/wp-content/uploads/2018/03/chinook.zip"),". The downloaded file is zipped so I will need to also unzip that file. (of course we can do that manually, but how savage is that)"),(0,d.kt)("pre",null,(0,d.kt)("code",{parentName:"pre",className:"language-python"},'from zipfile import ZipFile\nfrom urllib.request import urlretrieve\n\nfile_handle, _ = urlretrieve("https://www.sqlitetutorial.net/wp-content/uploads/2018/03/chinook.zip")\nzipfile = ZipFile(file_handle, \'r\')\nzipfile.extractall(".")\nzipfile.close()\n')),(0,d.kt)("p",null,"We'll need to use the ",(0,d.kt)("inlineCode",{parentName:"p"},"SQLAlchemy")," package from the Python Package Index."),(0,d.kt)("p",null,"Here we define the connection string a sqlite connection to a locally available SQLite Database file ",(0,d.kt)("inlineCode",{parentName:"p"},"chinook")),(0,d.kt)("pre",null,(0,d.kt)("code",{parentName:"pre",className:"language-python"},'from sqlalchemy import create_engine\n\nconnection_string = "sqlite:///chinook.db"\nengine = create_engine(connection_string)\n\ndbConnection = engine.connect()\n')),(0,d.kt)("pre",null,(0,d.kt)("code",{parentName:"pre",className:"language-python"},'import pandas as pd\n\ngenres_df = pd.read_sql("SELECT * FROM genres;", dbConnection)\ngenres_df\n')),(0,d.kt)(p,{mdxType:"HTMLOutputBlock"},(0,d.kt)("pre",null,(0,d.kt)("code",{parentName:"pre",className:"language-html"},'<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border="1" class="dataframe">\n  <thead>\n    <tr style="text-align: right;">\n      <th></th>\n      <th>GenreId</th>\n      <th>Name</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>1</td>\n      <td>Rock</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>2</td>\n      <td>Jazz</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>3</td>\n      <td>Metal</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>4</td>\n      <td>Alternative &amp; Punk</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>5</td>\n      <td>Rock And Roll</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>6</td>\n      <td>Blues</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>7</td>\n      <td>Latin</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>8</td>\n      <td>Reggae</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>9</td>\n      <td>Pop</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>10</td>\n      <td>Soundtrack</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>11</td>\n      <td>Bossa Nova</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>12</td>\n      <td>Easy Listening</td>\n    </tr>\n    <tr>\n      <th>12</th>\n      <td>13</td>\n      <td>Heavy Metal</td>\n    </tr>\n    <tr>\n      <th>13</th>\n      <td>14</td>\n      <td>R&amp;B/Soul</td>\n    </tr>\n    <tr>\n      <th>14</th>\n      <td>15</td>\n      <td>Electronica/Dance</td>\n    </tr>\n    <tr>\n      <th>15</th>\n      <td>16</td>\n      <td>World</td>\n    </tr>\n    <tr>\n      <th>16</th>\n      <td>17</td>\n      <td>Hip Hop/Rap</td>\n    </tr>\n    <tr>\n      <th>17</th>\n      <td>18</td>\n      <td>Science Fiction</td>\n    </tr>\n    <tr>\n      <th>18</th>\n      <td>19</td>\n      <td>TV Shows</td>\n    </tr>\n    <tr>\n      <th>19</th>\n      <td>20</td>\n      <td>Sci Fi &amp; Fantasy</td>\n    </tr>\n    <tr>\n      <th>20</th>\n      <td>21</td>\n      <td>Drama</td>\n    </tr>\n    <tr>\n      <th>21</th>\n      <td>22</td>\n      <td>Comedy</td>\n    </tr>\n    <tr>\n      <th>22</th>\n      <td>23</td>\n      <td>Alternative</td>\n    </tr>\n    <tr>\n      <th>23</th>\n      <td>24</td>\n      <td>Classical</td>\n    </tr>\n    <tr>\n      <th>24</th>\n      <td>25</td>\n      <td>Opera</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n'))),(0,d.kt)("p",null,"Let's add one item to the dataframe"),(0,d.kt)("pre",null,(0,d.kt)("code",{parentName:"pre",className:"language-python"},"genres_df = pd.concat([genres_df, pd.DataFrame.from_records([{'GenreId': '26', 'Name': 'Arabic Pop'}])], ignore_index=True)\ngenres_df\n")),(0,d.kt)(p,{mdxType:"HTMLOutputBlock"},(0,d.kt)("pre",null,(0,d.kt)("code",{parentName:"pre",className:"language-html"},'<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border="1" class="dataframe">\n  <thead>\n    <tr style="text-align: right;">\n      <th></th>\n      <th>GenreId</th>\n      <th>Name</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>1</td>\n      <td>Rock</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>2</td>\n      <td>Jazz</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>3</td>\n      <td>Metal</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>4</td>\n      <td>Alternative &amp; Punk</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>5</td>\n      <td>Rock And Roll</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>6</td>\n      <td>Blues</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>7</td>\n      <td>Latin</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>8</td>\n      <td>Reggae</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>9</td>\n      <td>Pop</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>10</td>\n      <td>Soundtrack</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>11</td>\n      <td>Bossa Nova</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>12</td>\n      <td>Easy Listening</td>\n    </tr>\n    <tr>\n      <th>12</th>\n      <td>13</td>\n      <td>Heavy Metal</td>\n    </tr>\n    <tr>\n      <th>13</th>\n      <td>14</td>\n      <td>R&amp;B/Soul</td>\n    </tr>\n    <tr>\n      <th>14</th>\n      <td>15</td>\n      <td>Electronica/Dance</td>\n    </tr>\n    <tr>\n      <th>15</th>\n      <td>16</td>\n      <td>World</td>\n    </tr>\n    <tr>\n      <th>16</th>\n      <td>17</td>\n      <td>Hip Hop/Rap</td>\n    </tr>\n    <tr>\n      <th>17</th>\n      <td>18</td>\n      <td>Science Fiction</td>\n    </tr>\n    <tr>\n      <th>18</th>\n      <td>19</td>\n      <td>TV Shows</td>\n    </tr>\n    <tr>\n      <th>19</th>\n      <td>20</td>\n      <td>Sci Fi &amp; Fantasy</td>\n    </tr>\n    <tr>\n      <th>20</th>\n      <td>21</td>\n      <td>Drama</td>\n    </tr>\n    <tr>\n      <th>21</th>\n      <td>22</td>\n      <td>Comedy</td>\n    </tr>\n    <tr>\n      <th>22</th>\n      <td>23</td>\n      <td>Alternative</td>\n    </tr>\n    <tr>\n      <th>23</th>\n      <td>24</td>\n      <td>Classical</td>\n    </tr>\n    <tr>\n      <th>24</th>\n      <td>25</td>\n      <td>Opera</td>\n    </tr>\n    <tr>\n      <th>25</th>\n      <td>26</td>\n      <td>Arabic Pop</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n'))),(0,d.kt)("p",null,"Let's update the database with the new data"),(0,d.kt)("pre",null,(0,d.kt)("code",{parentName:"pre",className:"language-python"},"genres_df.to_sql('genres', dbConnection, if_exists='replace', index=False)\n")),(0,d.kt)(c,{lang:"python",mdxType:"CodeOutputBlock"},(0,d.kt)("pre",null,(0,d.kt)("code",{parentName:"pre"},"    26\n"))),(0,d.kt)("p",null,"Let's see what's in the database table now"),(0,d.kt)("pre",null,(0,d.kt)("code",{parentName:"pre",className:"language-python"},'df2 = pd.read_sql("SELECT * FROM genres;", dbConnection)\ndf2\n')),(0,d.kt)(p,{mdxType:"HTMLOutputBlock"},(0,d.kt)("pre",null,(0,d.kt)("code",{parentName:"pre",className:"language-html"},'<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border="1" class="dataframe">\n  <thead>\n    <tr style="text-align: right;">\n      <th></th>\n      <th>GenreId</th>\n      <th>Name</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>1</td>\n      <td>Rock</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>2</td>\n      <td>Jazz</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>3</td>\n      <td>Metal</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>4</td>\n      <td>Alternative &amp; Punk</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>5</td>\n      <td>Rock And Roll</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>6</td>\n      <td>Blues</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>7</td>\n      <td>Latin</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>8</td>\n      <td>Reggae</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>9</td>\n      <td>Pop</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>10</td>\n      <td>Soundtrack</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>11</td>\n      <td>Bossa Nova</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>12</td>\n      <td>Easy Listening</td>\n    </tr>\n    <tr>\n      <th>12</th>\n      <td>13</td>\n      <td>Heavy Metal</td>\n    </tr>\n    <tr>\n      <th>13</th>\n      <td>14</td>\n      <td>R&amp;B/Soul</td>\n    </tr>\n    <tr>\n      <th>14</th>\n      <td>15</td>\n      <td>Electronica/Dance</td>\n    </tr>\n    <tr>\n      <th>15</th>\n      <td>16</td>\n      <td>World</td>\n    </tr>\n    <tr>\n      <th>16</th>\n      <td>17</td>\n      <td>Hip Hop/Rap</td>\n    </tr>\n    <tr>\n      <th>17</th>\n      <td>18</td>\n      <td>Science Fiction</td>\n    </tr>\n    <tr>\n      <th>18</th>\n      <td>19</td>\n      <td>TV Shows</td>\n    </tr>\n    <tr>\n      <th>19</th>\n      <td>20</td>\n      <td>Sci Fi &amp; Fantasy</td>\n    </tr>\n    <tr>\n      <th>20</th>\n      <td>21</td>\n      <td>Drama</td>\n    </tr>\n    <tr>\n      <th>21</th>\n      <td>22</td>\n      <td>Comedy</td>\n    </tr>\n    <tr>\n      <th>22</th>\n      <td>23</td>\n      <td>Alternative</td>\n    </tr>\n    <tr>\n      <th>23</th>\n      <td>24</td>\n      <td>Classical</td>\n    </tr>\n    <tr>\n      <th>24</th>\n      <td>25</td>\n      <td>Opera</td>\n    </tr>\n    <tr>\n      <th>25</th>\n      <td>26</td>\n      <td>Arabic Pop</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n'))),(0,d.kt)("h2",{id:"-from-mongodb"},"\ud83d\udce5 From MongoDB"),(0,d.kt)("p",null,"If you've taken Contemporary Database, you have already learned about One of the NoSQL Database options, MongoDB."),(0,d.kt)("p",null,"In the following example, I will show you how you can use Python to Query Data from a MongoDB."),(0,d.kt)("p",null,"Here we'll need to install the ",(0,d.kt)("inlineCode",{parentName:"p"},"PyMongo")," Package. Depending on the MongoDB instance you're trying to connect to, you will need an extra companion package. You can find out about that in this ",(0,d.kt)("a",{parentName:"p",href:"https://pymongo.readthedocs.io/en/stable/installation.html"},"link to the PyMongo Documentation"),". For instances:"),(0,d.kt)("ul",null,(0,d.kt)("li",{parentName:"ul"},"For AWS, you need to install ",(0,d.kt)("inlineCode",{parentName:"li"},"pymongo[aws]")),(0,d.kt)("li",{parentName:"ul"},"For ",(0,d.kt)("inlineCode",{parentName:"li"},"mongodb+srv")," connection strings, you'd need to install ",(0,d.kt)("inlineCode",{parentName:"li"},"pymongo[srv]"))),(0,d.kt)("p",null,"For the MongoDB instance on Mongo Atlas, we need ",(0,d.kt)("inlineCode",{parentName:"p"},"pymongo[srv]"),", ",(0,d.kt)("inlineCode",{parentName:"p"},"pipenv install 'pymongo[srv]'")),(0,d.kt)("pre",null,(0,d.kt)("code",{parentName:"pre",className:"language-python"},'import pandas as pd\nfrom pymongo import MongoClient\nimport os\nfrom dotenv import load_dotenv\n\nload_dotenv(override=True)\n\npd.set_option(\'display.max_columns\', None) # Otherwise, pandas would not be able to display the full content of each cell\n\n\ndef _connect_mongo(host, username, password, db):\n    """ A util for making a connection to mongo """\n\n    mongo_uri = \'mongodb+srv://%s:%s@%s/?retryWrites=true&w=majority"\' % (username, password, host)\n\n    conn = MongoClient(mongo_uri)\n\n    return conn[db]\n\n\ndef read_mongo(db, collection, query={}, no_id=True):\n    """ Read from Mongo and Store into DataFrame """\n\n    # Make a query to the specific DB and Collection\n    cursor = db[collection].find(query)\n\n    # Expand the cursor and construct the DataFrame\n    df =  pd.DataFrame(list(cursor))\n\n    # Delete the _id\n    if no_id:\n        del df[\'_id\']\n\n    return df\n\nusername = os.getenv("MONGO_USERNAME")\npassword = os.getenv("MONGO_PASSWORD")\n\ndb = _connect_mongo(host=\'it4063c.ykv1yjn.mongodb.net\', username=username, password=password, db=\'sample_airbnb\')\ndf = read_mongo(db=db, collection=\'listingsAndReviews\', query={\'bedrooms\': {\'$lt\': 2}}, no_id=False)\ndf.head()\n')),(0,d.kt)(p,{mdxType:"HTMLOutputBlock"},(0,d.kt)("pre",null,(0,d.kt)("code",{parentName:"pre",className:"language-html"},"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>_id</th>\n      <th>listing_url</th>\n      <th>name</th>\n      <th>summary</th>\n      <th>space</th>\n      <th>description</th>\n      <th>neighborhood_overview</th>\n      <th>notes</th>\n      <th>transit</th>\n      <th>access</th>\n      <th>interaction</th>\n      <th>house_rules</th>\n      <th>property_type</th>\n      <th>room_type</th>\n      <th>bed_type</th>\n      <th>minimum_nights</th>\n      <th>maximum_nights</th>\n      <th>cancellation_policy</th>\n      <th>last_scraped</th>\n      <th>calendar_last_scraped</th>\n      <th>accommodates</th>\n      <th>bedrooms</th>\n      <th>beds</th>\n      <th>number_of_reviews</th>\n      <th>bathrooms</th>\n      <th>amenities</th>\n      <th>price</th>\n      <th>weekly_price</th>\n      <th>monthly_price</th>\n      <th>cleaning_fee</th>\n      <th>extra_people</th>\n      <th>guests_included</th>\n      <th>images</th>\n      <th>host</th>\n      <th>address</th>\n      <th>availability</th>\n      <th>review_scores</th>\n      <th>reviews</th>\n      <th>first_review</th>\n      <th>last_review</th>\n      <th>security_deposit</th>\n      <th>reviews_per_month</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>10009999</td>\n      <td>https://www.airbnb.com/rooms/10009999</td>\n      <td>Horto flat with small garden</td>\n      <td>One bedroom + sofa-bed in quiet and bucolic ne...</td>\n      <td>Lovely one bedroom + sofa-bed in the living ro...</td>\n      <td>One bedroom + sofa-bed in quiet and bucolic ne...</td>\n      <td>This charming ground floor flat is located in ...</td>\n      <td>There\xb4s a table in the living room now, that d...</td>\n      <td>Easy access to transport (bus, taxi, car) and ...</td>\n      <td></td>\n      <td>I\xb4ll be happy to help you with any doubts, tip...</td>\n      <td>I just hope the guests treat the space as they...</td>\n      <td>Apartment</td>\n      <td>Entire home/apt</td>\n      <td>Real Bed</td>\n      <td>2</td>\n      <td>1125</td>\n      <td>flexible</td>\n      <td>2019-02-11 05:00:00</td>\n      <td>2019-02-11 05:00:00</td>\n      <td>4</td>\n      <td>1</td>\n      <td>2.0</td>\n      <td>0</td>\n      <td>1.0</td>\n      <td>[Wifi, Wheelchair accessible, Kitchen, Free pa...</td>\n      <td>317.00</td>\n      <td>1492.00</td>\n      <td>4849.00</td>\n      <td>187.00</td>\n      <td>0.00</td>\n      <td>1</td>\n      <td>{'thumbnail_url': '', 'medium_url': '', 'pictu...</td>\n      <td>{'host_id': '1282196', 'host_url': 'https://ww...</td>\n      <td>{'street': 'Rio de Janeiro, Rio de Janeiro, Br...</td>\n      <td>{'availability_30': 0, 'availability_60': 0, '...</td>\n      <td>{}</td>\n      <td>[]</td>\n      <td>NaT</td>\n      <td>NaT</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>1001265</td>\n      <td>https://www.airbnb.com/rooms/1001265</td>\n      <td>Ocean View Waikiki Marina w/prkg</td>\n      <td>A short distance from Honolulu's billion dolla...</td>\n      <td>Great studio located on Ala Moana across the s...</td>\n      <td>A short distance from Honolulu's billion dolla...</td>\n      <td>You can breath ocean as well as aloha.</td>\n      <td></td>\n      <td>Honolulu does have a very good air conditioned...</td>\n      <td>Pool, hot tub and tennis</td>\n      <td>We try our best at creating, simple responsive...</td>\n      <td>The general welfare and well being of all the ...</td>\n      <td>Condominium</td>\n      <td>Entire home/apt</td>\n      <td>Real Bed</td>\n      <td>3</td>\n      <td>365</td>\n      <td>strict_14_with_grace_period</td>\n      <td>2019-03-06 05:00:00</td>\n      <td>2019-03-06 05:00:00</td>\n      <td>2</td>\n      <td>1</td>\n      <td>1.0</td>\n      <td>96</td>\n      <td>1.0</td>\n      <td>[TV, Cable TV, Wifi, Air conditioning, Pool, K...</td>\n      <td>115.00</td>\n      <td>650.00</td>\n      <td>2150.00</td>\n      <td>100.00</td>\n      <td>0.00</td>\n      <td>1</td>\n      <td>{'thumbnail_url': '', 'medium_url': '', 'pictu...</td>\n      <td>{'host_id': '5448114', 'host_url': 'https://ww...</td>\n      <td>{'street': 'Honolulu, HI, United States', 'sub...</td>\n      <td>{'availability_30': 16, 'availability_60': 46,...</td>\n      <td>{'review_scores_accuracy': 9, 'review_scores_c...</td>\n      <td>[{'_id': '4765259', 'date': 2013-05-24 04:00:0...</td>\n      <td>2013-05-24 04:00:00</td>\n      <td>2019-02-07 05:00:00</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>10021707</td>\n      <td>https://www.airbnb.com/rooms/10021707</td>\n      <td>Private Room in Bushwick</td>\n      <td>Here exists a very cozy room for rent in a sha...</td>\n      <td></td>\n      <td>Here exists a very cozy room for rent in a sha...</td>\n      <td></td>\n      <td></td>\n      <td></td>\n      <td></td>\n      <td></td>\n      <td></td>\n      <td>Apartment</td>\n      <td>Private room</td>\n      <td>Real Bed</td>\n      <td>14</td>\n      <td>1125</td>\n      <td>flexible</td>\n      <td>2019-03-06 05:00:00</td>\n      <td>2019-03-06 05:00:00</td>\n      <td>1</td>\n      <td>1</td>\n      <td>1.0</td>\n      <td>1</td>\n      <td>1.5</td>\n      <td>[Internet, Wifi, Air conditioning, Kitchen, Bu...</td>\n      <td>40.00</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>0.00</td>\n      <td>1</td>\n      <td>{'thumbnail_url': '', 'medium_url': '', 'pictu...</td>\n      <td>{'host_id': '11275734', 'host_url': 'https://w...</td>\n      <td>{'street': 'Brooklyn, NY, United States', 'sub...</td>\n      <td>{'availability_30': 0, 'availability_60': 0, '...</td>\n      <td>{'review_scores_accuracy': 10, 'review_scores_...</td>\n      <td>[{'_id': '61050713', 'date': 2016-01-31 05:00:...</td>\n      <td>2016-01-31 05:00:00</td>\n      <td>2016-01-31 05:00:00</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>10030955</td>\n      <td>https://www.airbnb.com/rooms/10030955</td>\n      <td>Apt Linda Vista Lagoa - Rio</td>\n      <td>Quarto com vista para a Lagoa Rodrigo de Freit...</td>\n      <td></td>\n      <td>Quarto com vista para a Lagoa Rodrigo de Freit...</td>\n      <td></td>\n      <td></td>\n      <td></td>\n      <td></td>\n      <td></td>\n      <td></td>\n      <td>Apartment</td>\n      <td>Private room</td>\n      <td>Real Bed</td>\n      <td>1</td>\n      <td>1125</td>\n      <td>flexible</td>\n      <td>2019-02-11 05:00:00</td>\n      <td>2019-02-11 05:00:00</td>\n      <td>2</td>\n      <td>1</td>\n      <td>1.0</td>\n      <td>0</td>\n      <td>2.0</td>\n      <td>[TV, Cable TV, Internet, Wifi, Air conditionin...</td>\n      <td>701.00</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>250.00</td>\n      <td>0.00</td>\n      <td>1</td>\n      <td>{'thumbnail_url': '', 'medium_url': '', 'pictu...</td>\n      <td>{'host_id': '51496939', 'host_url': 'https://w...</td>\n      <td>{'street': 'Rio de Janeiro, Rio de Janeiro, Br...</td>\n      <td>{'availability_30': 28, 'availability_60': 58,...</td>\n      <td>{}</td>\n      <td>[]</td>\n      <td>NaT</td>\n      <td>NaT</td>\n      <td>1000.00</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>1003530</td>\n      <td>https://www.airbnb.com/rooms/1003530</td>\n      <td>New York City - Upper West Side Apt</td>\n      <td></td>\n      <td>Murphy bed, optional second bedroom available....</td>\n      <td>Murphy bed, optional second bedroom available....</td>\n      <td>Great neighborhood - many terrific restaurants...</td>\n      <td>My cat, Samantha, are in and out during the su...</td>\n      <td>Conveniently located near 1, 2, 3, B &amp; C subwa...</td>\n      <td>New York City!</td>\n      <td></td>\n      <td>No smoking is permitted in the apartment. All ...</td>\n      <td>Apartment</td>\n      <td>Private room</td>\n      <td>Real Bed</td>\n      <td>12</td>\n      <td>360</td>\n      <td>strict_14_with_grace_period</td>\n      <td>2019-03-07 05:00:00</td>\n      <td>2019-03-07 05:00:00</td>\n      <td>2</td>\n      <td>1</td>\n      <td>1.0</td>\n      <td>70</td>\n      <td>1.0</td>\n      <td>[Internet, Wifi, Air conditioning, Kitchen, El...</td>\n      <td>135.00</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>135.00</td>\n      <td>0.00</td>\n      <td>1</td>\n      <td>{'thumbnail_url': '', 'medium_url': '', 'pictu...</td>\n      <td>{'host_id': '454250', 'host_url': 'https://www...</td>\n      <td>{'street': 'New York, NY, United States', 'sub...</td>\n      <td>{'availability_30': 0, 'availability_60': 0, '...</td>\n      <td>{'review_scores_accuracy': 10, 'review_scores_...</td>\n      <td>[{'_id': '4351675', 'date': 2013-04-29 04:00:0...</td>\n      <td>2013-04-29 04:00:00</td>\n      <td>2018-08-12 04:00:00</td>\n      <td>0.00</td>\n      <td>NaN</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n"))),(0,d.kt)("h2",{id:"-via-web-scrapping"},"\ud83d\udce5 Via Web Scrapping"),(0,d.kt)("p",null,"Data is available in different structures and format. These formats are: "),(0,d.kt)("ol",null,(0,d.kt)("li",{parentName:"ol"},"Structured Data\nData that can be displayed in tabular formats. Often the format you find via Databases, CSV files, and sometimes APIs."),(0,d.kt)("li",{parentName:"ol"},"Unstructured Data\nThese are data that can't readily be presented as tables. It may include images, audio files, documents."),(0,d.kt)("li",{parentName:"ol"},"Semi-Structured Data\nThese are structured data that can't exactly fit in a tabular formats. For example, data that's represented as nested objects. (See the COVID API Response; the top level represents all the aggregates, then region specific data, county, city, ...etc. Each of those levels don't necessary contain the same data elements, and may include different features or properties. These are data that are often shared as APIs, JSON files, ...etc.")),(0,d.kt)("p",null,"One of the semi-structured-to unstructured data is data that's available on websites. They're not exactly always in a consumable state (even if they're tables). One way we can take advantage of this information is by Web Scrapping."),(0,d.kt)("p",null,"This is the process of extracting data from websites."),(0,d.kt)("p",null,"Let's say we found this data on Wikipedia on ",(0,d.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Wealth_distribution_by_country"},"the world distribution of wealth"),". The page contains this information in tables with no API or an easily downloadable CSV files. "),(0,d.kt)("p",null,(0,d.kt)("img",{alt:"Northern America - wealth distribution",src:e(3372).Z,width:"3170",height:"510"}),"\n",(0,d.kt)("img",{alt:"Central America - wealth distribution",src:e(2858).Z,width:"1578",height:"1870"})),(0,d.kt)("p",null,"and so on for every continent."),(0,d.kt)("h4",{id:"sidebar-html-tables"},"Sidebar: HTML Tables"),(0,d.kt)("p",null,"If you're not familiar with HTML as a markup language. Please review ",(0,d.kt)("a",{parentName:"p",href:"https://htmlcheatsheet.com/"},"the following website"),". For this particular part, we're only looking at the Table Markups."),(0,d.kt)("pre",null,(0,d.kt)("code",{parentName:"pre",className:"language-html"},"<table>\n  <thead>\n    <tr>\n      <th>Header cell 1</th>\n      <th>Header cell 2</th>\n    </tr>\n  </thead>\n\n  <tbody>\n    <tr>\n      <td>Row 1 - Cell 1</td>\n      <td>Row 1 - Cell 2</td>\n    </tr>\n    <tr>\n      <td>Row 2 - Cell 1</td>\n      <td>Row 2 - Cell 2</td>\n    </tr>\n  </tbody>\n</table>\n")),(0,d.kt)("p",null,"If you look at the Wikipedia page, above, you'll see there are multiple sections and html elements on the page. You'll also see multiple tables on the page. The browser receives the data as HTML code, and parses it to present it in a human-friendly format. To see the underlying HTML code, you can open the page inspector/developer tools.\n",(0,d.kt)("img",{alt:"open the html inspector",src:e(4137).Z,width:"3190",height:"1016"})),(0,d.kt)("blockquote",null,(0,d.kt)("p",{parentName:"blockquote"},"For any chromium-based browser (Chrome, Firefox, Brave, Edge, ...), you should be able to see the same option.")),(0,d.kt)("p",null,"See how you can see the code elements and what they represent on the web page.\n",(0,d.kt)("img",{alt:"HTML Inspector",src:e(7701).Z,width:"800",height:"392"})),(0,d.kt)("p",null,"Now we need to see if we can get the HTML code from this page to parse and extract the data from it. So we'll download the content of the URL as a string first."),(0,d.kt)("p",null,"We'll use the ",(0,d.kt)("a",{parentName:"p",href:"https://docs.python.org/3/library/urllib.html"},(0,d.kt)("inlineCode",{parentName:"a"},"URLLib")," Package"),". This Package contains multiple modules. The one we're interested in here is the ",(0,d.kt)("inlineCode",{parentName:"p"},"Request")," module, which contains multiple functions related to opening and reading URLs."),(0,d.kt)("p",null,(0,d.kt)("img",{alt:"URLLib",src:e(8016).Z,width:"1232",height:"592"})),(0,d.kt)("p",null,"Please take a moment to review the ",(0,d.kt)("a",{parentName:"p",href:"https://docs.python.org/3/library/urllib.request.html"},"documentation page"),", especially the ",(0,d.kt)("a",{parentName:"p",href:"https://docs.python.org/3/library/urllib.request.html#examples"},"Examples section"),". You'll need to be familiar with how you can review and understand documentations."),(0,d.kt)("admonition",{title:"\ud83e\udd89 Develop that skill",type:"info"},(0,d.kt)("p",{parentName:"admonition"},"Understanding the documentation is not going to be outdated, The libraries will. These tools will keep on getting updates. Don't memorize the syntax for those libraries but learn how to understand their documentation. That's the skill that you should learn from this lesson.")),(0,d.kt)("pre",null,(0,d.kt)("code",{parentName:"pre",className:"language-python"},"import urllib.request\n")),(0,d.kt)("pre",null,(0,d.kt)("code",{parentName:"pre",className:"language-python"},'html = urllib.request.urlopen("https://en.wikipedia.org/wiki/Wealth_distribution_by_country").read(500) # Read the first 500 characters\nhtml\n')),(0,d.kt)(c,{lang:"python",mdxType:"CodeOutputBlock"},(0,d.kt)("pre",null,(0,d.kt)("code",{parentName:"pre"},'    b\'<!DOCTYPE html>\\n<html class="client-nojs" lang="en" dir="ltr">\\n<head>\\n<meta charset="UTF-8"/>\\n<title>Wealth distribution by country - Wikipedia</title>\\n<script>document.documentElement.className="client-js";RLCONF={"wgBreakFrames":false,"wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgRequestId":"7a4f1b56-2331-4b09-82b\'\n'))),(0,d.kt)("p",null,"you can run the previous cell again without passing any numbers in the read function. This will return the entirety of the page. the problem there now is that we have to figure out ways to parse HTML string we receive to find the different elements of the page we're interested in. (not a very easy thing to do)"),(0,d.kt)("p",null,"For a moment, I thought the ",(0,d.kt)("inlineCode",{parentName:"p"},"parse")," module of the same package would be the answer here, however this module parses the URL itself."),(0,d.kt)("p",null,"Thankfully, some developer ran into the same problem. They developed and release ",(0,d.kt)("a",{parentName:"p",href:"https://www.crummy.com/software/BeautifulSoup/"},(0,d.kt)("inlineCode",{parentName:"a"},"BeautifulSoup"))),(0,d.kt)("p",null,"This is a python package that's built for HTML web scrapping, it's able to parse and interface with HTML documents."),(0,d.kt)("p",null,"It's a third party package, so I will need to install it first ",(0,d.kt)("inlineCode",{parentName:"p"},"pipenv install beautifulsoup4")),(0,d.kt)("p",null,"Let's now get the wikipedia page using ",(0,d.kt)("inlineCode",{parentName:"p"},"BeautifulSoup"),":"),(0,d.kt)("pre",null,(0,d.kt)("code",{parentName:"pre",className:"language-python"},"from bs4 import BeautifulSoup\nimport requests\n\nurl = \"https://en.wikipedia.org/wiki/Wealth_distribution_by_country\"\npage = requests.get(url) # Get the page\nsoup = BeautifulSoup(page.content, 'html.parser') # Parse the HTML as a string\nprint(soup.prettify()) # Print the parsed data of html\n")),(0,d.kt)("pre",null,(0,d.kt)("code",{parentName:"pre",className:"language-python"},"tables = soup.find_all('table')\n\n# Get the first table\ndf = pd.read_html(str(tables[0]))[0]\ndf\n")),(0,d.kt)(p,{mdxType:"HTMLOutputBlock"},(0,d.kt)("pre",null,(0,d.kt)("code",{parentName:"pre",className:"language-html"},'<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border="1" class="dataframe">\n  <thead>\n    <tr style="text-align: right;">\n      <th></th>\n      <th>nation</th>\n      <th>percent of world population</th>\n      <th>share of adult population</th>\n      <th>Net worth per capita (PPP)</th>\n      <th>Net worth per capita (exchange rates)</th>\n      <th>Percent of world net worth (PPP)</th>\n      <th>Percent of world net worth (exchange rates)</th>\n      <th>Real GDP per capita (PPP)</th>\n      <th>Real GDP per capita (exchange rates)</th>\n      <th>Percent of world GDP (PPP)</th>\n      <th>Percent of world GDP (exchange rates)</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>USA</td>\n      <td>4.67</td>\n      <td>71.39</td>\n      <td>143727.0</td>\n      <td>143727.0</td>\n      <td>25.4</td>\n      <td>32.65</td>\n      <td>35619.0</td>\n      <td>35619.0</td>\n      <td>21.97</td>\n      <td>31.49</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Canada</td>\n      <td>0.50</td>\n      <td>74.18</td>\n      <td>89252.0</td>\n      <td>70916.0</td>\n      <td>1.7</td>\n      <td>1.74</td>\n      <td>28731.0</td>\n      <td>22828.0</td>\n      <td>1.91</td>\n      <td>2.18</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>total</td>\n      <td>5.17</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>27.1</td>\n      <td>34.39</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>23.88</td>\n      <td>33.67</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n'))),(0,d.kt)("p",null,"We're able to get the table into a pandas DataFrame here. however, we don't really need to the last 2 rows here; the second form last is just a empty separator row, and the other is a total row. let's use pandas functions to get rid of those 2 rows. "),(0,d.kt)("pre",null,(0,d.kt)("code",{parentName:"pre",className:"language-python"},"# remove the last 2 rows of pandas DataFrame\ndf = df[:-2]\ndf\n")),(0,d.kt)(p,{mdxType:"HTMLOutputBlock"},(0,d.kt)("pre",null,(0,d.kt)("code",{parentName:"pre",className:"language-html"},'<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border="1" class="dataframe">\n  <thead>\n    <tr style="text-align: right;">\n      <th></th>\n      <th>nation</th>\n      <th>percent of world population</th>\n      <th>share of adult population</th>\n      <th>Net worth per capita (PPP)</th>\n      <th>Net worth per capita (exchange rates)</th>\n      <th>Percent of world net worth (PPP)</th>\n      <th>Percent of world net worth (exchange rates)</th>\n      <th>Real GDP per capita (PPP)</th>\n      <th>Real GDP per capita (exchange rates)</th>\n      <th>Percent of world GDP (PPP)</th>\n      <th>Percent of world GDP (exchange rates)</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>USA</td>\n      <td>4.67</td>\n      <td>71.39</td>\n      <td>143727.0</td>\n      <td>143727.0</td>\n      <td>25.4</td>\n      <td>32.65</td>\n      <td>35619.0</td>\n      <td>35619.0</td>\n      <td>21.97</td>\n      <td>31.49</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Canada</td>\n      <td>0.50</td>\n      <td>74.18</td>\n      <td>89252.0</td>\n      <td>70916.0</td>\n      <td>1.7</td>\n      <td>1.74</td>\n      <td>28731.0</td>\n      <td>22828.0</td>\n      <td>1.91</td>\n      <td>2.18</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n'))),(0,d.kt)("p",null,"But that's only the first table on the page. Let's import all of those table dynamically"),(0,d.kt)("pre",null,(0,d.kt)("code",{parentName:"pre",className:"language-python"},"print('we have %1d tables' % (len(tables)))\n")),(0,d.kt)(c,{lang:"python",mdxType:"CodeOutputBlock"},(0,d.kt)("pre",null,(0,d.kt)("code",{parentName:"pre"},"    we have 8 tables\n"))),(0,d.kt)("pre",null,(0,d.kt)("code",{parentName:"pre",className:"language-python"},"for i in range(1, len(tables)):\n    df = pd.concat([df, pd.read_html(str(tables[i]))[0]], ignore_index=True)\n    df = df[:-2]\ndf\n")),(0,d.kt)(p,{mdxType:"HTMLOutputBlock"},(0,d.kt)("pre",null,(0,d.kt)("code",{parentName:"pre",className:"language-html"},'<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border="1" class="dataframe">\n  <thead>\n    <tr style="text-align: right;">\n      <th></th>\n      <th>nation</th>\n      <th>percent of world population</th>\n      <th>share of adult population</th>\n      <th>Net worth per capita (PPP)</th>\n      <th>Net worth per capita (exchange rates)</th>\n      <th>Percent of world net worth (PPP)</th>\n      <th>Percent of world net worth (exchange rates)</th>\n      <th>Real GDP per capita (PPP)</th>\n      <th>Real GDP per capita (exchange rates)</th>\n      <th>Percent of world GDP (PPP)</th>\n      <th>Percent of world GDP (exchange rates)</th>\n      <th>rank</th>\n      <th>nation.1</th>\n      <th>percent of world population.1</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>USA</td>\n      <td>4.67</td>\n      <td>71.39</td>\n      <td>143727.0</td>\n      <td>143727.0</td>\n      <td>25.40</td>\n      <td>32.65</td>\n      <td>35619.0</td>\n      <td>35619.0</td>\n      <td>21.97</td>\n      <td>31.49</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Canada</td>\n      <td>0.50</td>\n      <td>74.18</td>\n      <td>89252.0</td>\n      <td>70916.0</td>\n      <td>1.70</td>\n      <td>1.74</td>\n      <td>28731.0</td>\n      <td>22828.0</td>\n      <td>1.91</td>\n      <td>2.18</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Argentina</td>\n      <td>0.61</td>\n      <td>63.17</td>\n      <td>38481.0</td>\n      <td>25410.0</td>\n      <td>0.88</td>\n      <td>0.75</td>\n      <td>11729</td>\n      <td>7745</td>\n      <td>0.94</td>\n      <td>0.89</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Bahamas</td>\n      <td>0.00</td>\n      <td>60.87</td>\n      <td>76364.0</td>\n      <td>53813.0</td>\n      <td>0.01</td>\n      <td>0.01</td>\n      <td>16793</td>\n      <td>14217</td>\n      <td>0.01</td>\n      <td>0.01</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Barbados</td>\n      <td>0.00</td>\n      <td>71.27</td>\n      <td>103787.0</td>\n      <td>58121.0</td>\n      <td>0.02</td>\n      <td>0.01</td>\n      <td>17526</td>\n      <td>9815</td>\n      <td>0.01</td>\n      <td>0.01</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>335</th>\n      <td>Chad</td>\n      <td>0.13</td>\n      <td>NaN</td>\n      <td>1728.0</td>\n      <td>353</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>167.0</td>\n      <td>Sierra Leone</td>\n      <td>0.07</td>\n    </tr>\n    <tr>\n      <th>336</th>\n      <td>Guinea-Bissau</td>\n      <td>0.02</td>\n      <td>NaN</td>\n      <td>1673.0</td>\n      <td>329</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>168.0</td>\n      <td>Chad</td>\n      <td>0.13</td>\n    </tr>\n    <tr>\n      <th>337</th>\n      <td>Yemen</td>\n      <td>0.29</td>\n      <td>NaN</td>\n      <td>1425.0</td>\n      <td>329</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>169.0</td>\n      <td>Niger</td>\n      <td>0.19</td>\n    </tr>\n    <tr>\n      <th>338</th>\n      <td>Ethiopia</td>\n      <td>0.01</td>\n      <td>NaN</td>\n      <td>1414.0</td>\n      <td>na</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>170.0</td>\n      <td>Burundi</td>\n      <td>na</td>\n    </tr>\n    <tr>\n      <th>339</th>\n      <td>Congo, Democratic Republic</td>\n      <td>0.82</td>\n      <td>NaN</td>\n      <td>1402.0</td>\n      <td>298</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>171.0</td>\n      <td>Tajikistan</td>\n      <td>0.1</td>\n    </tr>\n  </tbody>\n</table>\n<p>340 rows \xd7 14 columns</p>\n</div>\n'))))}m.isMDXComponent=!0},2858:(t,n,e)=>{e.d(n,{Z:()=>a});const a=e.p+"assets/images/central-america-69b4c4d9b91c91f363ed90936b89d9a4.png"},5222:(t,n,e)=>{e.d(n,{Z:()=>a});const a=e.p+"assets/images/cin-9407e04adcc73367e750e2c98c63eaaa.jpg"},7701:(t,n,e)=>{e.d(n,{Z:()=>a});const a=e.p+"assets/images/html-inspector-894146a030f711a6209e38f79c417481.gif"},7627:(t,n,e)=>{e.d(n,{Z:()=>a});const a=e.p+"assets/images/kaggle-profile-f014c6677ed1da1ed6d8adaa4bac162a.jpg"},3372:(t,n,e)=>{e.d(n,{Z:()=>a});const a=e.p+"assets/images/northern-america-b1c51145ac2e586e1cbafbdeaaba4372.png"},4137:(t,n,e)=>{e.d(n,{Z:()=>a});const a=e.p+"assets/images/table-inspect-ba5c7f4c873434688f2592702b222627.png"},8016:(t,n,e)=>{e.d(n,{Z:()=>a});const a=e.p+"assets/images/urllib-da447a83df5ab6593b8ff388905354ff.png"}}]);